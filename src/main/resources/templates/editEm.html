<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
	<title>Employee</title>
	<style>
		/* Căn giữa container */
		.container {
			display: flex;
			justify-content: center;
			align-items: center;
			margin-top: 20px;
			margin-bottom: 20px;
		}
		.passText, .emailText,.salaryText, .dobText {
            color: red; 
        }
	</style>
</head>

<body>
	<div class="container">
		<div class="row"
			style="border: 1px darkgrey solid; border-radius: 10px; width: 50%; margin: 0 auto; padding: 20px;">

			<div class="col-sm-12">

				<h2 class="myclass">Edit Employee</h2>
				<form th:action="@{/employee/edit}" th:object="${employee}" method="post"
					enctype="multipart/form-data">

					<div class="form-group">
						<label>Empoyee ID</label>
						<input type="text" th:field="*{id}" class="form-control" name="id" placeholder="Enter id"
							id="id" readonly>
					</div>
					<div class="form-group">
						<label>Full Name</label>
						<input type="text" th:field="*{fullName}" class="form-control" name="name"
							placeholder="Enter name" id="name" required>
					</div>
					<div class="form-group">
						<label>Dob</label>
						<input type="date" th:field="*{dob}" class="form-control" name="dob" id="dob" required>
						<span class="dobText" ></span>
					</div>

					<div class="form-group">
						<label>Role</label>
						<input type="text" th:field="*{role}" class="form-control" name="role" placeholder="Enter role"
							id="role" required>
					</div>
					<div class="form-group">
						<label>Gender</label>
						<div class="radio">
							<label class="checkbox-inline">
								<input type="radio" th:field="*{gender}" value="1">Male
							</label>
							<label class="checkbox-inline">
								<input type="radio" th:field="*{gender}" value="0">Female
							</label>
						</div>
					</div>
					<div class="form-group">
						<label>Address</label>
						<input type="text" th:field="*{address}" class="form-control" name="address"
							placeholder="Enter address" id="address" required>
					</div>

					<div class="form-group">
						<label>CCCD</label>
						<input type="text" th:field="*{idenId}" class="form-control" name="idenId"
							placeholder="Enter CCCD" id="idenId" required>
					</div>

					<div class="form-group">
						<label>Phone</label>
						<input type="tel" th:field="*{phone}" class="form-control" name="phone"
							placeholder="Enter phone" id="phone" required>
					</div>
					<div class="form-group">
						<label class="emailBox">Email</label>
						<input type="email" th:field="*{email}" class="form-control" name="email"
							placeholder="Enter email" id="email" required>
						<span class="emailText"></span>
					</div>

					<div class="form-group">
						<label>User Name</label>
						<input type="text" th:field="*{username}" class="form-control" name="username"
							placeholder="Enter username" id="username" required>
					</div>

					<div class="form-group">
						<label>Password</label>
						<input type="password" th:field="*{password}" class="form-control" name="password"
							placeholder="Enter password" id="password" required>
							<span class="passText"></span>

					</div>
					<div class="form-group">
						<label>Salary</label>
						<input type="number" th:field="*{salary}" class="form-control" name="salary"
							placeholder="Enter salary" id="salary">
							<span class="salaryText"></span>
					</div>

					<button type="submit" class="btn btn-primary" onclick="checkDuplicateEmail()">Save</button>
					<a class="btn btn-primary" href="/employee/list">Display List Employee</a>
				</form>
			</div>
		</div>
	</div>
	<script>
		// Lấy ngày hiện tại và định dạng thành yyyy-mm-dd
		var currentDate = new Date(); // Lấy ngày hiện tại
		var yyyy = currentDate.getFullYear(); 
		var mm = String(currentDate.getMonth() + 1).padStart(2, '0'); // thêm số 0 đằng trước nếu cần
		var dd = String(currentDate.getDate()).padStart(2, '0'); 
		var maxDate = yyyy + '-' + mm + '-' + dd; 

		// Đặt thuộc tính max của input date là ngày hiện tại
		document.getElementById("dob").setAttribute("max", maxDate);

		// Validate ngày sinh
		document.getElementById("dob").addEventListener("change", function () {
			var input = this.value; // Lấy ngày được chọn từ trường nhập ngày sinh
			var inputDate = new Date(input); 
			var currentDate = new Date(maxDate); 

			if (inputDate > currentDate) { 
                dobText.innerHTML = 'Dob can not be in the future.';
				this.value = ""; // Xóa giá trị ngày được chọn từ trường nhập ngày sinh
			} else {
                dobText.innerHTML = '';// Xóa thông báo lỗi nếu không có lỗi
			}
		});

        const form = document.querySelector('form');
        const email = document.getElementById('email');
        const password = document.getElementById('password');
        const passText = document.querySelector('.passText');
        const emailText = document.querySelector('.emailText');
        const dobText = document.querySelector('.dobText');
        const salaryText = document.querySelector('.salaryText');
        const emailError = document.getElementById('emailError');

        password.addEventListener('input', checkPassword);
        email.addEventListener('input', checkEmail);

        function checkPassword() {
            const passPattern = /(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;
            if (password.value.match(passPattern)) {
                passText.innerHTML = '';
                return true;
            } else {
                passText.innerHTML = 'Your password must be at least 6 characters as well as contain at least one uppercase, one lowercase, and one number.';
                return false;
            }
        }

        function checkFormSubmission() {
            return  checkPassword() && checkEmail();
        }

        function checkEmail() {
            const emailPattern = /[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/;
            if (email.value.match(emailPattern)) {
                emailText.innerHTML = '';
                errorMessage.style.display = 'none';
                return true;
            } else {
                emailText.innerHTML = 'Must be a valid email address.';
                errorMessage.style.display = 'none';
                return false;
            }
        }

        document.getElementById("salary").addEventListener("input", function () {
			var input = this.value; 
			if (input<=0) { 
                salaryText.innerHTML = 'Salary must be a positive number'; // Hiển thị thông báo lỗi
				this.value="";
			} else {
				document.getElementById("salaryError").innerText = ""; // Xóa thông báo lỗi nếu không có lỗi
			}
		});
	</script>
</body>

</html>